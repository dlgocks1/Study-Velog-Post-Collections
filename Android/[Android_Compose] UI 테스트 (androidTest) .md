* TDDê¸°ë°˜ ê°œë°œì„ ì§„í–‰í•˜ë¼
* í…ŒìŠ¤íŠ¸ì½”ë“œ ì‘ì„±ì— ì •ì„±ì„ ë‹¤í•´ë¼.

ë“±ì˜ í…ŒìŠ¤íŠ¸ì½”ë“œì— ëŒ€í•œ ì¤‘ìš”ì„±ì„ ì •ë§ ì—¬ëŸ¬ê³³ì—ì„œ ë“¤ì„ ìˆ˜ ìˆì—ˆë‹¤. í•˜ì§€ë§Œ ì•ˆë“œë¡œì´ë“œ ê°œë°œì„ ì§„í–‰í•˜ë©° í…ŒìŠ¤íŠ¸ ì½”ë“œë¥¼ ì‘ì„±í•´ë³¸ ì ì´ ì†ì— ê¼½ì„ ì •ë„ë¡œ ì ì–´ í•œë²ˆ ì•ˆë“œë¡œì´ë“œì—ì„œì˜ í…ŒìŠ¤íŠ¸ ì½”ë“œë¥¼ ì‘ì„±í•´ë³´ê³ ì í•œë‹¤.

## ë‹¨ìœ„í…ŒìŠ¤íŠ¸ì™€ UIí…ŒìŠ¤íŠ¸

> ë‹¨ìœ„ í…ŒìŠ¤íŠ¸ëŠ” ì‘ìš© í”„ë¡œê·¸ë¨ì—ì„œ í…ŒìŠ¤íŠ¸ ê°€ëŠ¥í•œ ê°€ì¥ ì‘ì€ ì†Œí”„íŠ¸ì›¨ì–´ë¥¼ ì‹¤í–‰í•˜ì—¬ ì˜ˆìƒëŒ€ë¡œ ë™ì‘í•˜ëŠ”ì§€ í™•ì¸í•˜ëŠ” í…ŒìŠ¤íŠ¸ì´ë‹¤. 

ë‹¨ìœ„ í…ŒìŠ¤íŠ¸ì—ì„œ í…ŒìŠ¤íŠ¸ ëŒ€ìƒ ë‹¨ìœ„ì˜ í¬ê¸°ëŠ” ì—„ê²©í•˜ê²Œ ì •í•´ì ¸ ìˆì§€ ì•Šì§€ë§Œ, ì¼ë°˜ì ìœ¼ë¡œ í´ë˜ìŠ¤ ë˜ëŠ” ë©”ì†Œë“œ ìˆ˜ì¤€ìœ¼ë¡œ ì‘ì€ í…ŒìŠ¤íŠ¸ë¥¼ ì˜ë¯¸í•œë‹¤.

> UI í…ŒìŠ¤íŠ¸ëŠ” ì• í”Œë¦¬ì¼€ì´ì…˜ì˜ ì‚¬ìš©ì ì¸í„°í˜ì´ìŠ¤ (UI)ë¥¼ í…ŒìŠ¤íŠ¸í•˜ëŠ” ê³¼ì •ì´ë‹¤. ì§€ì •ëœ ì‹œë‚˜ì´ë¡œì— ë”°ë¼ ê¸°ëŠ¥ì„ í…ŒìŠ¤íŠ¸í•˜ê³  UI ë™ì‘ì„ í™•ì¸í•œë‹¤. 

ì§€ê¸ˆê¹Œì§€ ê°œë°œí•˜ë©° ê±°ì˜ ëª¨ë“ í…ŒìŠ¤íŠ¸ë¥¼ ìˆ˜ë™ìœ¼ë¡œ ì§„í–‰í•˜ì˜€ê³  ë§ì€ ì‹œê°„ì´ ì†Œìš”ë¬ë‹¤. í•˜ì§€ë§Œ ìë™í™”ëœ í…ŒìŠ¤íŠ¸ë„êµ¬ë¥¼ ì´ìš©í•˜ë©´ ì½”ë“œ ë³€ê²½ í›„ ì–´í”Œë¦¬ì¼€ì´ì…˜ì´ ì œëŒ€ë¡œ ë™ì‘í•˜ëŠ”ì§€ í™•ì¸í•˜ê¸° ìœ„í•´ì„œ ìœ ìš©í•˜ë‹¤.
ì•ˆë“œë¡œì´ë“œì—ì„œëŠ” `Espresso`, `Robolectric`ë“± ë‹¤ì–‘í•œ UI í…ŒìŠ¤íŠ¸ ë„êµ¬ë¥¼ ì œê³µí•˜ì§€ë§Œ ì´ë²ˆ ê¸€ì—ì„œëŠ” `androidx.compose.ui.test.junit4`ë¥¼ í™œìš©í•  ì˜ˆì •ì´ë‹¤.

---

# Composeì—ì„œì˜ UI í…ŒìŠ¤íŠ¸ ğŸ§ª

`androidx.compose.ui.test.junit4` ë‚´ë¶€ì˜ í•¨ìˆ˜ë“¤ì„ í™œìš©í•´ UIí…ŒìŠ¤íŠ¸ë¥¼ ì§„í–‰í•´ë³´ê³ ì í•œë‹¤.

## Semantics ğŸ—ƒï¸ 

![](https://velog.velcdn.com/images/cksgodl/post/ecbb0fe5-849c-4e4a-b724-57fd75bb90e6/image.png)

ì»´í¬ì¦ˆì—ì„œ ì»´í¬ì§€ì…˜ì€ ì•±ì˜ `UI`ë¥¼ ì„¤ëª…í•˜ê³  ì»´í¬ì €ë¸”ì„ ì‹¤í–‰í•˜ì—¬ ìƒì„±ëœë‹¤.  ì»´í¬ì§€ì…˜ì€ `UI`ë¥¼ ì„¤ëª…í•˜ëŠ” ì»´í¬ì €ë¸”ë¡œ êµ¬ì„±ëœ íŠ¸ë¦¬ êµ¬ì¡°ì´ë‹¤.
í…ŒìŠ¤íŠ¸ì—ì„œëŠ” ì´ íŠ¸ë¦¬ë¥¼ ì‚¬ìš©í•˜ì—¬ ì•±ê³¼ ìƒí˜¸ì‘ìš©í•˜ê³  ì´ì— ê´€í•œ `assertion`ì„ ë§Œë“ ë‹¤.  ì»´í¬ì €ë¸”ì˜ `ì‹œë§¨í‹± ì˜ë¯¸`ì— ê´€í•œ ì •ë³´ëŠ” ì´ íŠ¸ë¦¬ì— í¬í•¨ë˜ì–´ìˆë‹¤.

~~ë¼ê³  `ì•ˆë“œë¡œì´ë“œ ë””ë²¨ë¡œí¼`ì—ì„œ ì„¤ëª…í•˜ê³  ìˆì§€ë§Œ ë¬´ìŠ¨ ì†Œë¦¬ì¸ì§€ ë‹¹ìµœ ì•Œì•„ë¨¹ì„ ìˆ˜ ì—†ë‹¤.~~
> ì»´í¬ì¦ˆì—ì„œëŠ” ì»´í¬ì§€ì…˜ì„ í†µí•´ `UI Tree`ê°€ ìƒì„±ë˜ê³  ê°ê°ì˜ ê·¸ë ¤ì§„ ì»´í¬ì €ë¸”ì—ê²Œ ì˜ë¯¸ê°€ ë‹´ê¸´ ì†ì„±(ì‹œë§¨í‹±)ì´ ë¶€ì—¬ëœë‹¤. ì´ë¥¼ í†µí•´ í…ŒìŠ¤íŠ¸ í”„ë ˆì„ì›Œí¬ì—ì„œ ë·°ì— ì ‘ê·¼í•˜ê³  í…ŒìŠ¤íŠ¸ë¥¼ í•  ìˆ˜ ìˆëŠ” ê²ƒì´ë‹¤.

## ì‹œë©˜í‹± ì†ì„±ì˜ ì˜ˆì œ ğŸ‘

ì‹œë§¨í‹± ì†ì„±ë“¤ì—ëŠ” ì»´í¬ì €ë¸”ì˜ ì˜ë¯¸ë¥¼ ì „ë‹¬í•˜ëŠ” ì†ì„±ì´ í¬í•¨ë˜ì–´ ìˆë‹¤.
ì˜ˆë¥¼ ë“¤ì–´ `Text`ì»´í¬ì €ë¸”ì—ì„œëŠ” `text`ê°€, `Icon`ì—ëŠ” `contentDescription`ì†ì„±ì´ í¬í•¨ë  ìˆ˜ ìˆë‹¤.


`Layout Inspector`ë¥¼ í†µí•´ ì†ì„±ì„ ì‹œê°ì ìœ¼ë¡œ ë³¼ ìˆ˜ ìˆìœ¼ë©° ìŠ¤ìœ„ì¹˜ì˜ ì‹œë§¨í‹± ë…¸ë“œëŠ” ë‹¤ìŒê³¼ ê°™ë‹¤.
![](https://velog.velcdn.com/images/cksgodl/post/c3f3d81d-9c7c-46d6-9ac3-67176dcf23de/image.png)

## ì‹œë©˜í‹± ì†ì„±ì„ í†µí•´ ë…¸ë“œë¥¼ ì°¾ê³  í…ŒìŠ¤íŠ¸í•´ë³´ì ğŸ„

ì´ëŸ¬í•œ ìŠ¤ìœ„ì¹˜ì˜ `ì‹œë§¨í‹± ë…¸ë“œ`ë¥¼ í™œìš©í•˜ì—¬ ë…¸ë“œë¥¼ ì°¾ì•„ ìƒí˜¸ì‘ìš©í•˜ê³  í…ŒìŠ¤íŠ¸í•  ìˆ˜ ìˆë‹¤.

ì˜ˆì œì™€ ê°™ì´ ì–´ë–»ê²Œ ë·°(ë…¸ë“œ)ë¥¼ ì°¾ê³  ì´ë¥¼ í…ŒìŠ¤íŠ¸í•˜ëŠ”ì§€ ì•Œì•„ë³´ì. ë‹¤ìŒì€ ìŠ¤ìœ„ì¹˜ê°€ `off`ìƒíƒœì¸ì§€ í™•ì¸í•˜ëŠ” ì†ŒìŠ¤ì´ë‹¤.
```
val mySwitch = SemanticsMatcher.expectValue(
    SemanticsProperties.Role, Role.Switch
)
composeTestRule.onNode(mySwitch)
    .performClick()
    .assertIsOff()
```


#### `onNode`í•¨ìˆ˜ë€ ë¬´ì—‡ì¸ê°€??

```
fun onNode(
	matcher: SemanticsMatcher,
    useUnmergedTree: Boolean = false
): SemanticsNodeInteraction
```

> `onNode` í•¨ìˆ˜ëŠ” `androidx.compose.ui.test.junit4.ComposeTestRule` í´ë˜ìŠ¤ì— í¬í•¨ë˜ì–´ ìˆëŠ” í•¨ìˆ˜ì´ë‹¤. `Compose UI Testing`ì„ ìœ„í•œ í•¨ìˆ˜ì´ë©°, `ì‹œë©˜í‹±ë§¤ì²˜`ë¥¼ í†µí•´ ë·°ë¥¼ ì°¾ì„ ìˆ˜ ìˆë‹¤.

`onNode`í•¨ìˆ˜ ë‚´ë¶€ì›¨ì„œëŠ” ì¸ìë¡œ `SemanticsMatcher` í´ë˜ìŠ¤ë¥¼ í†µí•´ ì›í•˜ëŠ” ë…¸ë“œë¥¼ ì°¾ì„ ìˆ˜ ìˆë‹¤.


`sementicsMatcher.expectValue`ëŠ” ë‹¤ìŒê³¼ ê°™ë‹¤. 
```
fun <T> expectValue(key: SemanticsPropertyKey<T>, expectedValue: T): SemanticsMatcher {
	return SemanticsMatcher("${key.name} = '$expectedValue'") {
    	it.config.getOrElseNullable(key) { null } == expectedValue
	}
}
```
`key`ê°’ìœ¼ë¡œëŠ” `SemanticsPropertyKey`ì˜ ê°’ì„, `value`ê°’ìœ¼ë¡œëŠ” í•´ë‹¹ ê°’ì„ ë„£ìœ¼ë©´ ëœë‹¤. 
ë˜í•œ `inline fun`ìœ¼ë¡œ `and`, `or` ë° `not`, `matches`, `matchesAny`ë“±ì„ ì œê³µí•˜ê³  ìˆìŒìœ¼ë¡œ ì´ë¥¼ í™œìš©í•´ íŠ¹ì • ë·°ë¥¼ ì°¾ì•„ í…ŒìŠ¤íŠ¸í•  ìˆ˜ ìˆë‹¤.


```
val mySwitch = SemanticsMatcher.expectValue(
    SemanticsProperties.Role, Role.Switch
)

val myTag = SemanticsMatcher.expectValue(
    SemanticsProperties.TestTag, "TestTag"
)

// Switchì—­í• ì„ ìˆ˜í–‰í•˜ë©°, íƒœê·¸ê°€ `TestTag`ì¸ ë·°ê°€ ìˆëŠ”ì§€ í™•ì¸í•œë‹¤.
composeTestRule.onNode(mySwitch and myTag).assertDoesNotExist() 
```

ì´ëŸ¬í•œ `sementicsMatcher`ì„ ì§ì ‘ ì…ë ¥í•  ìˆ˜ë„ ìˆê³  `Junit4`ì—ì„œëŠ” ìˆ˜ ë§ì€ ë§¤ì³ë¥¼ í•¨ìˆ˜ë¡œ ê°ì‹¸ì„œ ì œê³µí•´ì£¼ê³  ìˆë‹¤.

```
fun hasTestTag(testTag: String): SemanticsMatcher =
    SemanticsMatcher.expectValue(SemanticsProperties.TestTag, testTag)
    
fun isToggleable(): SemanticsMatcher =
    hasKey(SemanticsProperties.ToggleableState)

fun isFocused(): SemanticsMatcher =
    SemanticsMatcher.expectValue(SemanticsProperties.Focused, true)

fun hasText(
    text: String,
    substring: Boolean = false,
    ignoreCase: Boolean = false
): SemanticsMatcher {
	// ...
}

// ì›í•˜ëŠ” í•¨ìˆ˜ë“¤ì„ ì¡°í•©í•´ ë…¸ë“œë¥¼ ì°¾ê¸°
composeTestRule.onNode(hasTestTag("Button") and hasNoClickAction()).assertExists()
```

ë˜í•œ `onNoe`í•¨ìˆ˜ ë¿ë§Œ ì•„ë‹ˆë¼ 
* `onNodeWithContentDescription`
* `onNodeWithTag`
* `onNodeWIthText`
* `onRoot`

ë“±ì„ í†µí•´ ë…¸ë“œë¥¼ ì°¾ëŠ” í™•ì¥í•¨ìˆ˜ë„ ì œê³µí•œë‹¤.

```
composeTestRule.onNodeWithTag("Test Button2").performClick()
composeTestRule.onNodeWithText("Clicked!").assertExists()
composeTestRule.onNodeWithContentDescription("IMG_PROFILE").assertExists()
```

## `composeTestRule`ë€? ğŸ¤”

ìœ„ì—ì„œ ë¶€í„° ê³„ì† `composeTestRule`ì´ë¼ëŠ” ê²ƒì„ ì‚¬ìš©í–ˆëŠ”ë° ì´ëŠ” ë¬´ì—‡ì¼ê¹Œ?

```
@get:Rule
val composeTestRule = createComposeRule()
```

> `createComposeRule()`ì€ `AndroidX` í…ŒìŠ¤íŠ¸ ë¼ì´ë¸ŒëŸ¬ë¦¬ì—ì„œ ì œê³µí•˜ëŠ” `Compose UI` í…ŒìŠ¤íŠ¸ë¥¼ ìœ„í•œ `Rule`ì´ë‹¤.

`createComposeRule()` í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•˜ë©´ `Compose UI` í…ŒìŠ¤íŠ¸ë¥¼ ìœ„í•œ í…ŒìŠ¤íŠ¸ í™˜ê²½ì„ ë¹ ë¥´ê³  ì‰½ê²Œ ì„¤ì •í•  ìˆ˜ ìˆë‹¤. 

_ì´ `Rule`ì€ `@Before` ë©”ì„œë“œì—ì„œ ìë™ìœ¼ë¡œ `Compose UI` í…ŒìŠ¤íŠ¸ í™˜ê²½ì„ ì„¤ì •í•˜ê³ , `@After` ë©”ì„œë“œì—ì„œ ìë™ìœ¼ë¡œ ë¦¬ì†ŒìŠ¤ë¥¼ í•´ì œí•œë‹¤._

íŠ¹ì • ì•¡í‹°ë¹„í‹°ë¥¼ ì§€ì •í•˜ê³  ì‹¶ë‹¤ë©´ `createAndroidComposeRule<ACTIVITY_NAME>()` ì„ í†µí•´ ìƒì„±í•  ìˆ˜ ìˆë‹¤.

> `createComposeRule`ì€ í…ŒìŠ¤íŠ¸ ì‹œì‘ì „ `Compose UI`í™˜ê²½ì„ ìë™ìœ¼ë¡œ ì„¤ì •í•´ ì£¼ê³  í…ŒìŠ¤íŠ¸ê°€ ëë‚¬ì„ ë•Œ ìë™ìœ¼ë¡œ ë¦¬ì†ŒìŠ¤ë¥¼ í•´ì œí•´ì¤€ë‹¤.

## í…ŒìŠ¤íŠ¸ë£°ì„ ì ìš©í•´ ë·°ë¥¼ ê·¸ë¦¬ê³  í…ŒìŠ¤íŠ¸í•˜ì. ğŸ‘

```
class ExampleComposeTest {

    @get:Rule
    val composeTestRule = createComposeRule()

    @Test
    fun testButton() {
        // Composable í•¨ìˆ˜ë¥¼ í˜¸ì¶œí•˜ì—¬ UIë¥¼ ì‘ì„±í•©ë‹ˆë‹¤.
        composeTestRule.setContent {
            MyScreenContent()
        }
       
		// ì‘ì„±ëœ ë·°ì˜ ë…¸ë“œë¥¼ ì°¾ê³  ì´ë¥¼ í…ŒìŠ¤íŠ¸í•©ë‹ˆë‹¤.
    	composeTestRule.onNodeWithTag("Text Field").assertExists()

	}
}
```

`assert` í•¨ìˆ˜ë¥¼ í†µí•´ í•´ë‹¹ ë…¸ë“œë¥¼ í…ŒìŠ¤íŠ¸í•œë‹¤.  

#### ë‹¤ìŒì€ ë…¸ë“œì˜ ìƒíƒœë¥¼ í…ŒìŠ¤íŠ¸í•˜ê¸° ìœ„í•œ `assert`í•¨ìˆ˜ë“¤ì´ë‹¤.

```
assertDoesNotExist : íŠ¸ë¦¬ êµ¬ì¡°ì— ë…¸ë“œê°€ ì¡´ì¬í•˜ì§€ ì•ŠëŠ”ì§€ í…ŒìŠ¤íŠ¸í•œë‹¤.
assertExists : íŠ¸ë¦¬ì— ë…¸ë“œê°€ ì¡´ì¬í•˜ëŠ”ì§€ í…ŒìŠ¤íŠ¸í•œë‹¤.

assertIsDisplayed : ë…¸ë“œê°€ í˜„ì¬ í™”ë©´ì— ê·¸ë ¤ì§€ëŠ”ì§€ í…ŒìŠ¤íŠ¸í•œë‹¤.
assertIsNotDisplayed : ë…¸ë“œê°€ í˜„ì¬ í™”ë©´ì— ê·¸ë ¤ì§€ì§€ ì•ŠëŠ”ì§€ í…ŒìŠ¤íŠ¸í•œë‹¤.

assertIsEnabled : ë…¸ë“œê°€ í˜„ì¬ í™œì„±í™” ìƒíƒœì¸ì§€ í…ŒìŠ¤íŠ¸í•œë‹¤.
assertIsNotEnabled : ë…¸ë“œê°€ í˜„ì¬ ë¹„í™œì„±í™” ìƒíƒœì¸ì§€ í…ŒìŠ¤íŠ¸í•œë‹¤.
ë…¸ë“œê°€ enable ì‹œë©˜í‹± ì†ì„±ì„ ê°€ì§€ê³ ìˆì§€ ì•Šìœ¼ë©´ ì—ëŸ¬

assertIsOn : ë…¸ë“œê°€ í˜„ì¬ ì²´í¬ ìƒíƒœì¸ì§€ í…ŒìŠ¤íŠ¸í•œë‹¤.
assertIsOff : ë…¸ë“œê°€ í˜„ì¬ ì²´í¬ ìƒíƒœê°€ ì•„ë‹Œì§€ í…ŒìŠ¤íŠ¸í•œë‹¤.
ë…¸ë“œê°€ toggleableí•˜ì§€ ì•Šìœ¼ë©´ ì—ëŸ¬

assertIsSelected : ë…¸ë“œê°€ í˜„ì¬ ì„ íƒ ìƒíƒœì¸ì§€ í…ŒìŠ¤íŠ¸í•œë‹¤.
assertIsNotSelected : ë…¸ë“œê°€ í˜„ì¬ ì„ íƒë˜ì§€ ì•Šì€ ìƒíƒœì¸ì§€ í…ŒìŠ¤íŠ¸í•œë‹¤.
ë…¸ë“œê°€ selectableí•˜ì§€ ì•Šìœ¼ë©´ ì—ëŸ¬

assertIsToggleable : ë…¸ë“œê°€ í† ê¸€ì¸ì§€ í…ŒìŠ¤íŠ¸í•œë‹¤.
assertIsSelectable : ë…¸ë“œê°€ ì„ íƒê°€ëŠ¥í•œì§€ í…ŒìŠ¤íŠ¸í•œë‹¤.

assertIsFocused : ë…¸ë“œê°€ í¬ì»¤ìŠ¤ ìƒíƒœì¸ì§€ í…ŒìŠ¤íŠ¸í•œë‹¤.
assertIsNotFocused : ë…¸ë“œê°€ í¬ì»¤ìŠ¤ ìƒíƒœê°€ ì•„ë‹Œì§€ í…ŒìŠ¤íŠ¸í•œë‹¤.

assertContentDescriptionEquals(vararg values: String)
	: ë…¸ë“œì˜ ContentDescriptionê³¼ ë™ì¼í•œì§€ í…ŒìŠ¤íŠ¸í•œë‹¤.
assertContentDescriptionContains 
	: ë…¸ë“œì˜ ContentDescriptionì„ í¬í•¨í•˜ëŠ”ì§€ í…ŒìŠ¤íŠ¸í•œë‹¤.
    
assertTextEquals : ë…¸ë“œ(Text, EditableText)ê°€ í•´ë‹¹ í…ìŠ¤íŠ¸ì™€ ë™ì¼í•œì§€ í…ŒìŠ¤íŠ¸í•œë‹¤.
assertTextContains : ë…¸ë“œ(Text, EditableText)ê°€ í•´ë‹¹ í…ìŠ¤íŠ¸ë¥¼ ê°€ì§€ëŠ”ì§€ í…ŒìŠ¤íŠ¸í•œë‹¤.
    
assertValueEquals : ë…¸ë“œì˜ StateDescriptionê³¼ ë™ì¼í•œì§€ í…ŒìŠ¤íŠ¸í•œë‹¤.
assertRangeInfoEquals : ë…¸ë“œì˜ ProgresBarê³¼ ë™ì¼í•œì§€ í…ŒìŠ¤íŠ¸í•œë‹¤.

assertHasClickAction : ë…¸ë“œê°€ í´ë¦­ì•¡ì…˜ì„ ê°€ì§€ê³  ìˆëŠ”ì§€ í…ŒìŠ¤íŠ¸í•œë‹¤.
assertHasNoClickAction : ë…¸ë“œê°€ í´ë¦­ì•¡ì…˜ì´ ì—†ëŠ”ì§€ í…ŒìŠ¤íŠ¸í•œë‹¤.


assert(matcher: SemanticsMatcher) : ë§¤ì³ë¥¼ ë§Œì¡±í•˜ëŠ”ì§€ í…ŒìŠ¤íŠ¸í•œë‹¤.
assertCountEquals(expectedSize: Int) : ë…¸ë“œì˜ ê²°ê³¼ê°€ ê°¯ìˆ˜ì™€ ë™ì¼í•œì§€ í…ŒìŠ¤íŠ¸í•œë‹¤.
assertAny(matcher : SemantisMatcher) : ì–´ë–¤ ë§¤ì³ë¼ë„ ë§Œì¡±í•˜ëŠ”ì§€ í…ŒìŠ¤íŠ¸í•œë‹¤.
assertAll(matcher : SemanticsMatcher) : ëª¨ë“  ë§¤ì³ê°€ ë§Œì¡±í•˜ëŠ”ì§€ í…ŒìŠ¤íŠ¸í•œë‹¤.
```

#### ë‹¤ìŒì€ ë…¸ë“œì˜ í¬ê¸°ë¥¼ í…ŒìŠ¤íŠ¸í•˜ê¸° ìœ„í•œ assertí•¨ìˆ˜ë“¤ì´ë‹¤.

```
assertWidthIsEqualTo(expectedWidth: Dp) 
assertTouchWidthIsEqualTo(expectedWidth: Dp) : ê°€ë¡œ í„°ì¹˜ ë„“ì´ê°€ ë™ì¼í•œì§€ í…ŒìŠ¤íŠ¸í•œë‹¤.

assertHeightIsEqualTo(expectedHeight: Dp)
assertTouchHeightIsEqualTo(expectedHeight: Dp) : ì„¸ë¡œ í„°ì¹˜ ë„“ì´ê°€ ë™ì¼í•œì§€ í…ŒìŠ¤íŠ¸í•œë‹¤.

assertPositionInRootIsEqualTo(
    expectedLeft: Dp,
    expectedTop: Dp
) : ë£¨íŠ¸ í¬ì§€ì…˜ìœ¼ë¡œ ë¶€í„° ìƒëŒ€ìœ„ì¹˜ë¥¼ í…ŒìŠ¤íŠ¸í•œë‹¤.

// ë“±ë“±,,,
```


#### ë‹¤ìŒì€ ë…¸ë“œì˜ ì•¡ì…˜ì„ ì •ì˜í•˜ê¸° ìœ„í•œ í•¨ìˆ˜ë“¤ì´ë‹¤.
```
// Actions
performClick : ë…¸ë“œë¥¼ í´ë¦­í•œë‹¤.
performScrollTo : ë…¸ë“œë¥¼ ìŠ¤í¬ë¡¤í•œë‹¤.
scrollToNode : ì§€ì • ë…¸ë“œê¹Œì§€ ìŠ¤í¬ë¡¤í•œë‹¤.
performScrollToIndex : ìŠ¤í¬ë¡¤ê°€ëŠ¥í•œ ì½˜í…Œì´ë„ˆì—ì„œ í•´ë‹¹ ìì‹ìœ„ì¹˜ê¹Œì§€ ìŠ¤í¬ë¡¤í•œë‹¤.
performScrollToKey : í•´ë‹¹ í‚¤ê°’ê¹Œì§€ ìŠ¤í¬ë¡¤í•œë‹¤.
performScrollToNode : ìŠ¤í¬ë¡¤ ê°€ëŠ¥í•œ ì½˜í…Œì´ë„ˆì—ì„œ í•´ë‹¹ ë…¸ë“œê¹Œì§€ ìŠ¤í¬ë¡¤í•œë‹¤.
performGesture : ì œìŠ¤ì²˜ì´ë²¤íŠ¸ë¥¼ ì‹¤í–‰í•œë‹¤.
performTouchInput : í„°ì¹˜ì´ë²¤íŠ¸ë¥¼ ì‹¤í–‰í•œë‹¤.
performMouseInput : ë§ˆìš°ìŠ¤ì´ë²¤íŠ¸ë¥¼ ì‹¤í–‰í•œë‹¤.

// TextActions
performTextClearance : í…ìŠ¤íŠ¸ë¥¼ í´ë¦¬ì–´í•œë‹¤.
performTextInput : í…ìŠ¤íŠ¸ë¥¼ ì…ë ¥í•œë‹¤.
performTextInputSelection : í…ìŠ¤íŠ¸ Selectionì„ ì„ íƒí•œë‹¤.
performTextReplacement : í…ìŠ¤íŠ¸ë¥¼ ìˆ˜ì •í•œë‹¤.
performIMEAction : IMEì•¡ì…˜ì„ ì‹¤í–‰í•œë‹¤.

ë“±ë“±...
```


ì´ë ‡ê²Œ ì²« ë²ˆì§¸ `Compose UI`í…ŒìŠ¤íŠ¸ê°€ ì„±ê³µí•˜ì˜€ë‹¤.
![](https://velog.velcdn.com/images/cksgodl/post/1585e4ba-7fcd-4d46-909f-bd271798f43c/image.png)


## TDDê¸°ë°˜ìœ¼ë¡œ ë¡œê·¸ì¸ í˜ì´ì§€ ì‘ì„±í•´ë³´ê¸°

ìš”êµ¬ì‚¬í•­ ê¸°ëŠ¥ì€ ë‹¤ìŒê³¼ ê°™ë‹¤.
```
ì•„ì´ë”” ë¹„ë°€ë²ˆí˜¸ë¥¼ ì…ë ¥ë°›ëŠ”ë‹¤.
1. ì•„ì´ë””ëŠ” 7ê¸€ì ì´ìƒì´ì–´ì•¼ í•œë‹¤.
2. ë¹„ë°€ë²ˆí˜¸ëŠ” ìˆ«ì, ì˜ì–´, íŠ¹ìˆ˜ë¬¸ìë¥¼ í•˜ë‚˜ì´ìƒì”© í¬í•¨í•˜ê³  8ê¸€ì ì´ìƒì´ì–´ì•¼ í•œë‹¤.
```

ìœ„ì˜ ìš”êµ¬ëœ ì œì‹œì‚¬í•­ëŒ€ë¡œ ë¨¼ì € í…ŒìŠ¤íŠ¸ ì½”ë“œë¥¼ ì‘ì„±í•œë‹¤.
```
class LoginIdPasswdScreenTest {

	@get:Rule
    val composeTestRule = createComposeRule()

    @Test
    fun `ì•„ì´ë””ê°€_7ê¸€ì_ì´í•˜ì´ë©´_ë¡œê·¸ì¸ë²„íŠ¼ì´_ë¹„í™œì„±í™”ëœë‹¤`() {
        composeTestRule.setContent {
            LoginIdPasswdScreen()
        }
        composeTestRule.onNodeWithTag(testTag = "ID_TEXT_FIELD")
            .performTextInput("123456")
        composeTestRule.onNodeWithTag(testTag = "PASSWD_TEXT_FIELD")
            .performTextInput("123456123a@s")
        composeTestRule.onNodeWithText("ë¡œê·¸ì¸").assertIsNotEnabled()
    }

    @Test
    fun `ë¹„ë°€ë²ˆí˜¸ì—_íŠ¹ìˆ˜ë¬¸ìê°€_ì—†ìœ¼ë©´_ë¡œê·¸ì¸ë²„íŠ¼ì´_ë¹„í™œì„±í™”ëœë‹¤`() {
        composeTestRule.setContent {
            LoginIdPasswdScreen()
        }
        composeTestRule.onNodeWithTag(testTag = "ID_TEXT_FIELD")
            .performTextInput("123456")
        composeTestRule.onNodeWithTag(testTag = "PASSWD_TEXT_FIELD")
            .performTextInput("12345612as")
        composeTestRule.onNodeWithText("ë¡œê·¸ì¸").assertIsNotEnabled()
    }

    @Test
    fun `ë¹„ë°€ë²ˆí˜¸ì—_ë¬¸ìê°€_ì—†ìœ¼ë©´_ë¡œê·¸ì¸ë²„íŠ¼ì´_ë¹„í™œì„±í™”ëœë‹¤`() {
        composeTestRule.setContent {
            LoginIdPasswdScreen()
        }
        composeTestRule.onNodeWithTag(testTag = "ID_TEXT_FIELD")
            .performTextInput("123456")
        composeTestRule.onNodeWithTag(testTag = "PASSWD_TEXT_FIELD")
            .performTextInput("12345612@@@@#")
        composeTestRule.onNodeWithText("ë¡œê·¸ì¸").assertIsNotEnabled()
    }

    @Test
    fun `ë¹„ë°€ë²ˆí˜¸ì—_ìˆ«ìê°€_ì—†ìœ¼ë©´_ë¡œê·¸ì¸ë²„íŠ¼ì´_ë¹„í™œì„±í™”ëœë‹¤`() {
        composeTestRule.setContent {
            LoginIdPasswdScreen()
        }
        composeTestRule.onNodeWithTag(testTag = "ID_TEXT_FIELD")
            .performTextInput("123456")
        composeTestRule.onNodeWithTag(testTag = "PASSWD_TEXT_FIELD")
            .performTextInput("asdasdadasd@@@@#")
        composeTestRule.onNodeWithText("ë¡œê·¸ì¸").assertIsNotEnabled()
    }

    @Test
    fun `ë¹„ë°€ë²ˆí˜¸ê°€_8ì_ë¯¸ë§Œì´ë©´_ë¡œê·¸ì¸ë²„íŠ¼ì´_ë¹„í™œì„±í™”ëœë‹¤`() {
        composeTestRule.setContent {
            LoginIdPasswdScreen()
        }
        composeTestRule.onNodeWithTag(testTag = "ID_TEXT_FIELD")
            .performTextInput("1234567")
        composeTestRule.onNodeWithTag(testTag = "PASSWD_TEXT_FIELD")
            .performTextInput("1234a@b")
        composeTestRule.onNodeWithText("ë¡œê·¸ì¸").assertIsNotEnabled()
    }

    @Test
    fun `ì•„ì´ë””ì™€_ë¹„ë°€ë²ˆí˜¸ê°€_ëª¨ë‘_í˜•ì‹ì—_ë§ë‹¤ë©´_ë¡œê·¸ì¸ë²„íŠ¼ì´_í™œì„±í™”ëœë‹¤`() {
        composeTestRule.setContent {
            LoginIdPasswdScreen()
        }
        composeTestRule.onNodeWithTag(testTag = "ID_TEXT_FIELD")
            .performTextInput("1234567")
        composeTestRule.onNodeWithTag(testTag = "PASSWD_TEXT_FIELD")
            .performTextInput("123123asd@#")
        composeTestRule.onNodeWithText("ë¡œê·¸ì¸").assertIsEnabled()
    }

}
```

ì¼ë‹¨ ìƒê°í•  ìˆ˜ ìˆëŠ” ì •ë„ì˜ ì˜ˆì™¸ ì¼€ì´ìŠ¤ë§Œì„ ì‘ì„±í•˜ê³  ì½”ë“œë¥¼ ì‘ì„±í•œë‹¤. 
_ì§€ê¸ˆ ë³´ë‹ˆ ì´ì •ë„ì˜ ì½”ë“œëŠ”`UI í…ŒìŠ¤íŠ¸`ê°€ ì•„ë‹Œ `ìœ ë‹› í…ŒìŠ¤íŠ¸`ì— ì‘ì„±í•˜ëŠ” ê²ƒì´ ë§ëŠ” ê²ƒ ê°™ë‹¤ëŠ” ìƒê°ì´ ë“ ë‹¤._

ì‘ì„±í•œ í…ŒìŠ¤íŠ¸ì½”ë“œë¥¼ ê¸°ë°˜ìœ¼ë¡œ ì‹¤ì œ UIë¥¼ ì‘ì„±í•˜ì—¬ ë³´ì.

```
val PASSWD_REGEX =
    Regex("""^(?=.*[A-Za-z])(?=.*\d)(?=.*[@${'$'}!%*#?&])[A-Za-z\d@${'$'}!%*#?&]{8,}${'$'}""")

@Composable
fun LoginIdPasswdScreen() {

    var id by remember { mutableStateOf("") }
    var passwd by remember { mutableStateOf("") }

    Column(modifier = Modifier.fillMaxSize()) {
        LoginIdPasswd(
            id = id,
            passwd = passwd,
            updateId = { id = it },
            updatePasswd = { passwd = it }
        )

        Row {
            Text(text = "íšŒì›ê°€ì…")
            Text(text = "ë¹„ë°€ë²ˆí˜¸ ì°¾ê¸°")
        }
        Button(onClick = { /*TODO*/ }) {
            Text(text = "ì¹´ì¹´ì˜¤ ë¡œê·¸ì¸")
        }
        Button(onClick = { /*TODO*/ }) {
            Text(text = "ë„¤ì´ë²„ ë¡œê·¸ì¸")
        }
    }
}

@Preview
@Composable
private fun LoginIdPasswd(
    id: String = "",
    passwd: String = "",
    updateId: (String) -> Unit = {},
    updatePasswd: (String) -> Unit = {},
) {
    Text(text = "ì•ˆë…•í•˜ì„¸ìš”.\në¡œì¦ˆë°ì´ì¦ˆì…ë‹ˆë‹¤.")
    Text(text = "ì•„ì´ë””")
    TextField(
        modifier = Modifier.testTag("ID_TEXT_FIELD"),
        value = id,
        onValueChange = updateId,
        label = { Text(text = "ì•„ì´ë””") })
    Text(text = "ë¹„ë°€ë²ˆí˜¸")
    TextField(
        modifier = Modifier.testTag("PASSWD_TEXT_FIELD"),
        value = passwd,
        onValueChange = updatePasswd,
        label = { Text(text = "ë¹„ë°€ë²ˆí˜¸") })
    Button(
        onClick = { /*TODO*/ },
        enabled = id.length >= 7 && PASSWD_REGEX.matches(passwd)
    ) {
        Text(text = "ë¡œê·¸ì¸")
    }
}
```

![](https://velog.velcdn.com/images/cksgodl/post/698f2cea-2f8e-408f-acd6-d284098e8e3b/image.png)

`ì•„ì´ë””`ì™€ `ë¹„ë°€ë²ˆí˜¸`ì— ë”°ë¼ë²„íŠ¼ì´ `enable`, `disable` ë˜ëŠ” ê°„ë‹¨í•œ ë·°ë¥¼ ì‘ì„±í•˜ì˜€ë‹¤. 

ì´ì œ í…ŒìŠ¤íŠ¸ë¥¼ ì§„í–‰í•´ ë³´ì•˜ë‹¤.

![](https://velog.velcdn.com/images/cksgodl/post/364ddccf-41e4-46b7-8f1b-4a856660ca3b/image.gif)

ìˆ˜ë™ìœ¼ë¡œ ì•„ì´ë”” íŒ¨ìŠ¤ì›Œë“œë¥¼ ì…ë ¥í•˜ì§€ ì•Šì•„ë„ ì•Œì•„ì„œ ì—ë®¬ë ˆì´í„°ë¥¼ í†µí•´ í…ŒìŠ¤íŠ¸ë¥¼ ì§„í–‰í•´ ì¤€ë‹¤!

![](https://velog.velcdn.com/images/cksgodl/post/d9d3feaf-47d0-4e90-9f1c-d5a11bc03e81/image.png)

ì´ì œ `TDD`ì˜ ë§ˆì§€ë§‰ ë‹¨ê³„ë¡œì¨ ì½”ë“œì˜ `ì¤‘ë³µ ì½”ë“œ ì œê±°`, `ì¼ë°˜í™”` ë“±ì˜ `ë¦¬íŒ©í† ë§`ì„ ìˆ˜í–‰í•˜ì.

ì¼ë‹¨ ì²« ë²ˆì§¸ ë‹¨ê³„ë¡œì¨ ì»´í¬ì¦ˆì˜ `setContent`ë¥¼ ì´ˆê¸° 1íšŒë§Œ ì‹¤í–‰í•˜ë„ë¡ ë³€ê²½í•˜ì. - ì¤‘ë³µì œê±°
```
class LoginIdPasswdScreenTest {
    @get:Rule
    val composeTestRule = createComposeRule()

    @Before
    fun setUp() {
        composeTestRule.setContent {
            LoginIdPasswdScreen()
        }
    }

}
```

ê·¸ë¦¬ê³  ì‚¬ìš©ë˜ëŠ” ë§¤ê°œë³€ìˆ˜ë“¤ì„ ëª¨ë‘ ìƒìˆ˜ë¡œ ì¶”ì¶œí•˜ì. (`ParameterizedTest`ë¥¼ ì´ìš©í•´ë„ ì¢‹ìŒ)

```
companion object {
    const val VERIFIED_ID = "Test1234"
    const val VERIFIED_PASSWD = "123123asd@#"
    const val NOT_VERIFIED_ID = "T123"
    const val NOT_CONTAINS_NUMBER_PASSWD = "asdasdadasd@@@@#"
    const val NOT_CONTAINS_CHARACTER_PASSWD = "123456123@@@#"
    const val NOT_CONTAINS_SPECIAL_CHARACTER_PASSWD = "123456123asdasd"
    const val WITHIN_8_CHARACTERS_PASSWD = "1234a@b"
}
```
í…ŒìŠ¤íŠ¸ ì½”ë“œê°€ ë‹¤ìŒê³¼ ê°™ì´ ë§¤ìš° ê¹”ë”í•´ ì¡ŒìŒì„ ë³¼ ìˆ˜ ìˆë‹¤.
```
@Test
fun `ì•„ì´ë””ì™€_ë¹„ë°€ë²ˆí˜¸ê°€_ëª¨ë‘_í˜•ì‹ì—_ë§ë‹¤ë©´_ë¡œê·¸ì¸ë²„íŠ¼ì´_í™œì„±í™”ëœë‹¤`() {
    composeTestRule.onNodeWithTag(testTag = "ID_TEXT_FIELD")
        .performTextInput(VERIFIED_ID)
    composeTestRule.onNodeWithTag(testTag = "PASSWD_TEXT_FIELD")
        .performTextInput(VERIFIED_PASSWD)
    composeTestRule.onNodeWithText("ë¡œê·¸ì¸").assertIsEnabled()
}
```


ì´ì œ ë·°ì— ë””ìì¸ì„ ì…íˆê³  ë‹¤ìŒ í…ŒìŠ¤íŠ¸ë¥¼ ì‘ì„±í•˜ëŸ¬ ë– ë‚˜ë³´ì. ğŸ‘


## ì°¸ê³ ìë£Œ

[Composeì˜ ì‹œë§¨í‹± - Android Developer](https://developer.android.com/jetpack/compose/semantics?hl=ko)

[Compose - UI Test by Choi Sang Rok](https://velog.io/@evergreen_tree/Compose-UI-Test)